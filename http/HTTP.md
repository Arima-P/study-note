# HTTP

> 超文本传输协议

## 主要版本

### 1.0

- 任何格式都可以发送
- 除了 `GET` ，增加 `POST` ，`HEAD` 命令
- 请求和响应格式发生了变化，除了数据部分，每次通讯都必须包含头部信息
- 只使用 `header` 中的 `if-modified-since` `expires` 作为缓存失败的标准
- 不支持断点续传

### 1.1

- 引入持久链接，即 `TCP` 连接默认不关闭，可以被多个请求复用
- 引入管道机制，即一个 `TCP` 连接中，客户端可以同时发送多个请求
- 新增 `E-tag`，`If-Unmodified-Since`, `If-Match`, `If-None-Match` 缓存控制标头来控制缓存失效
- 支持断点续传，通过使用请求头中的 `Range` 来实现
- 使用了虚拟网络，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个 IP 地址
- 增加 `PUT` ，`PATCH` `OPTIONS` `DELETE` 模式

#### 存在的问题

- 传输过程都是明文的，客户端、服务器端都无法验证对方的身份，无法保证安全性
- 虽然引入了管道机制，但是所有数据通讯都是按顺序的，服务器通常处理完一个回应，再去继续处理下一个，会造成对头阻塞
- 默认开启 `keep-alive`，弥补了多次创建连接带来的延迟，但是对服务器带来了压力，
- 如果想并发多个请求，必须使用多个 `TCP` 连接，浏览器为了控制资源，对单个域名有 6-8 个 `TCP` 连接的请求限制

### 2.0

- **二进制分帧**，彻底的二进制协议，头部、数据体都是二进制，并且统称 _帧_ ：头信息帧、数据帧
- **头部压缩**， HTTP 1.1 版本会出现 _User-Agent、Cookie、Accept、Server、Range_ 等字段可能会占用几百甚至几千字节，而 Body 却经常只有几十字节，所以导致头部偏重。HTTP 2.0 使用 `HPACK` 算法进行压缩。
- **多路复用**，复用 `TCP` 连接，一个连接里，客户端、浏览器都可以同时发多个请求或响应，且不用按顺序，解决对头阻塞的问题
- **服务器推送**，允许服务器未经请求，主动向客户端发送请求
- **请求优先级**，可以设置数据帧的优先级，让服务端优先处理重要资源
